package crypto;

import crypto.exceptions.BadKeyException;
import crypto.exceptions.CiphertextException;
import crypto.exceptions.KeyNotLoadedException;

import java.io.FileNotFoundException;
import java.security.InvalidKeyException;

/**
 * A wrapper for basic cryptographic functionality found in Java APIs, e.g.
 * javax.crypto, as well as in third party APIs, such as org.bouncycastle.crypto
 *
 * Created by Matthew Kindy II and Matt Bernhard on 11/3/2014.
 */
public interface ICryptoType {

    /**
     * Decrypts a cipherText generated by this ICryptoType.
     *
     * @param cipherText    a byte array to be decrypted
     * @return              the plaintext decrypted from the ciphertext
     *
     * @throws java.security.InvalidKeyException
     * @throws CipherException
     * @throws crypto.exceptions.KeyNotLoadedException
     */
    public byte[] decrypt(ICiphertext cipherText) throws InvalidKeyException, KeyNotLoadedException, CipherException, CiphertextException;

    /**
     * Encrypts a plainText according to the ICryptoType's protocol.
     *
     * @param plainText     a byte array to be encrypted
     * @return              the ciphertext of the plaintext according to the protocol
     *
     * @throws java.security.InvalidKeyException
     * @throws CipherException
     * @throws crypto.exceptions.KeyNotLoadedException
     */
    public ICiphertext encrypt(byte[] plainText) throws InvalidKeyException, KeyNotLoadedException, CipherException;

    /**
     * Given a filePath, extracts the Keys from the file and checks if they are proper keys for the
     * protocol. If they are, calls the proper submethod, else throws a BadKeyException.
     *
     * @param filePaths      a String array specifying the locations of the IKeys to be loaded
     *
     * @throws BadKeyException if the ICryptoType does not support the type of Key that was loaded
     * @throws java.io.FileNotFoundException
     */
    public void loadKeys(String[] filePaths) throws BadKeyException, FileNotFoundException;


    public String toString();

}
